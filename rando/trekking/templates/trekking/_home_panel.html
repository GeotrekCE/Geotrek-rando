{% load i18n static leaflet_tags trekking_tags %}

{% include "trekking/_share.html" with title=TITLE %}

{% if pjax %}
  <title>{{ TITLE }}</title>
{% endif %}

<div id="filters-bar">
  <h2 class="hidden">{% trans "Filters" %}</h2>

  <div id="basic-filters">
    <div class="difficulty span">
      <label for="difficulty">{% trans "Difficulty" %}</label>
      <div class="slider-wrap">
        <div id="difficulty" data-filter="difficulty"></div>
      </div>
      <div class="slider-value first">{% trans "Very easy" %}</div>
      <div class="slider-value">{% trans "Easy" %}</div>
      <div class="slider-value">{% trans "Medium" %}</div>
      <div class="slider-value last">{% trans "Hard" %}</div>
    </div>
    <div class="duration span">
      <label for="duration">{% trans "Duration" %}</label>
      <div class="slider-wrap">
        <div id="duration" data-filter="duration"></div>
      </div>
      <div class="slider-value first">{% trans "1/2 day" %}</div>
      <div class="slider-value">{% trans "Day" %}</div>
      <div class="slider-value last">&gt; {% trans "2 days" %}</div>
    </div>
    <div class="altitude span">
      <label for="altitude">{% trans "Climb" %}</label>
      <div class="slider-wrap">
        <div id="altitude" data-filter="altitude"></div>
      </div>
      <div class="slider-value first">&lt; 300m</div>
      <div class="slider-value">600m</div>
      <div class="slider-value">1000m</div>
      <div class="slider-value last">&gt;1400m</div>
    </div>

    <div class="theme span">
      <label for="theme">{% trans "Thematic" %}</label>
      {% for theme in themes %}
        <div class="filter" data-filter="theme" data-id="{{ theme.id }}" id="theme-{{ theme.id }}">
          {{ theme|pictogram }}
      </div>
      {% endfor %}
    </div>

    <div id="filters-actions" class="span">
      <span>{% trans "Reset" %}</span><br/>
      <a class="btn utils icon-fontawesome-webfont-1" id="clear-filters" href="#" data-toggle="tooltip" title="{% trans "Reset filters" %}"></a>
    </div>

    <div id="advanced-filters">

      <div class="filter-bloc usage">
        <label for="usage" class="hidden">{% trans "Usages" %}</label>
        <select id="usage" class="chosen-select" tabindex="2" multiple="" data-filter="usage" data-placeholder="{% trans "Usages" %}">
        {% for usage in usages %}
          <option data-filter="usage" data-id="{{ usage.id }}" value="{{ usage.id }}">{{ usage.label }}</option>
        {% endfor %}
        </select>
      </div>

      <div class="filter-bloc route">
        <label for="route" class="hidden">{% trans "Route" %}</label>
        <select id="route" class="chosen-select" tabindex="2" multiple="" data-filter="route"  data-placeholder="{% trans "Route" %}">
        {% for route in routes %}
          <option data-filter="route" data-id="{{ route.id }}" value="{{ route.id|safe }}">{{ route.label }}</option>
        {% endfor %}
        </select>
      </div>

      <div class="filter-bloc vallee">
        <label for="district" class="hidden">{% trans "Valleys" %}</label>
        <select id="district" class="chosen-select" tabindex="2" multiple="" data-filter="district" data-placeholder="{% trans "Valleys" %}">
        {% for district in districts %}
          <option data-filter="district" data-id="{{ district.id }}" value="{{ district.id }}">{{ district.name }}</option>
        {% endfor %}
        </select>
      </div>

      <div class="filter-bloc cities">
        <label for="city" class="hidden">{% trans "Cities" %}</label>
        <select id="city" class="chosen-select" tabindex="2" multiple="" data-filter="city" data-placeholder="{% trans "Cities" %}">
        {% for city in cities %}
          <option data-filter="city" data-id="{{ city.code }}" value="{{ city.code|safe }}">{{ city.name }}</option>
        {% endfor %}
        </select>
      </div>

    </div>
    <!--  advanced-filters-->
  </div>

</div>
<!--  search-bar-->

<div class="search-tabs side-bar" id="side-bar">

  <button id="toggle-header-mobile" class="icon-elusive-icons-1">
    <img class="logo" src="{% overridable "img/icon-64.png" %}" />
  </button>

  <div id="toggle-side-bar" class="icon-left-open-mini"></div>

  <div id="text-search" class="search1">
    <div class="span4">
      <form class="navbar-search pull-left">
        <label for="search" class="hidden">{% trans "Search" %}</label>
        <input type="text" class="search-query" placeholder="{% trans "Name, Valley, ..."%}" data-filter="search" id="search"/>
        <div class="icon-search"></div>
      </form>
    </div>
  </div>

  <div id="result-backpack-tabs" class="tabbable">
    <ul class="nav nav-tabs">
      <li id="tab-results" class="active">
        <a href="#results" class="icon-search">
          <span class="badge badge-warning">{{ treks|length }}</span> {% trans "Results" %}</a>
      </li>
      <li id="tab-backpack">
        <a href="#backpack" class="icon-backpack">
          <span class="badge">0</span> <span class="text">{% trans "Favorites" %}</span></a>
      </li>
    </ul>

    <div id="result-backpack-content" class="tab-content">
      <div class="tab-pane active" id="results">
        <h2 class="hidden">{% trans "Results" %}</h2>
        <p id="noresult" style="display:none" class="tab-content-empty">{% trans "No result" %}</p>
        {% for trek in treks %}
            {% include "trekking/_trek_result.html" with show="True" backpack="False" %}
        {% endfor %}
      </div>

      <div class="tab-pane" id="backpack">
        <h2 class="hidden">{% trans "Favorites" %}</h2>
        <p id="backpackempty" style="display:none" class="tab-content-empty">{% trans "Empty" %}</p>
        {% for trek in treks %}
            {% include "trekking/_trek_result.html" with show="False" backpack="True" %}
        {% endfor %}
      </div>
    </div>
  </div>

</div>
<!-- sidebar -->

{% include "trekking/_navigation.html" with title="HOME" %}

{% leaflet_map 'mainmap' fitextent=False creatediv=False callback="mainmapInit" loadevent="rando:foo" %}{# Such loadevent will prevent automatic map initialization #}

<div id="mainmap-tag" style="display: none"><!-- custom tag to detect loaded page--></div>
